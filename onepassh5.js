!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof def&&def.amd?def("GOP",t):(n=n||self).GOP=t()}(this,function(){"use strict";var uid=function(){return parseInt(1e4*Math.random())+(new Date).valueOf()},guid=function(){return c()+c()+c()+c()+c()+c()+c()+c()};function c(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function PureEvent(){this.n={}}function extend(n,t){for(var e in t)if(t.hasOwnProperty(e)){var o=t[e];n[e]=o}}PureEvent.prototype={t:function(n,t){var e=this;return e.n[n]?e.n[n].push(t):e.n[n]=[t],e},e:function(n,t){var e=this.n[n];if(e){for(var o=0,i=e.length;o<i;o+=1)e[o](t);return this}},o:function(){this.n={}}};var GATEWAY_FAIL="gateway_fail",GATEWAY_SUCCESS="gateway_success",_Promise=(q=function(n){return"function"==typeof n},s=function(n){n()},u=function(t,n){if(t===n)t.i(new TypeError);else if(n instanceof v)n.then(function(n){u(t,n)},function(n){t.i(n)});else if(q(n)||"object"==typeof(i=n)&&null!==i){var e;try{e=n.then}catch(r){return v.r(r),void t.i(r)}var o=!1;if(q(e))try{e.call(n,function(n){o||(o=!0,u(t,n))},function(n){o||(o=!0,t.i(n))})}catch(r){if(o)return;o=!0,t.i(r)}else t.u(n)}else t.u(n);var i},w=!(t.prototype={enqueue:function(n){var t=this,e={ele:n,next:null};null===t.c?t.c=this.s=e:(t.s.next=e,t.s=t.s.next)},dequeue:function(){var n=this;if(null===n.c)throw new Error("queue is empty");var t=n.c.ele;return n.c=n.c.next,t},isEmpty:function(){return null===this.c},clear:function(){this.c=this.a=null},each:function(n){var t=this;t.isEmpty()||(n(t.dequeue()),t.each(n))}}),v.debug=function(){w=!0},v.r=function(n){w&&"undefined"!=typeof console&&console.error(n)},v.prototype={PENDING:0,RESOLVED:1,REJECTED:-1,u:function(n){var t=this;t.f===t.PENDING&&(t.f=t.RESOLVED,t.d=n,t.m())},i:function(n){var t=this;t.f===t.PENDING&&(t.f=t.REJECTED,t.h=n,t.m())},m:function(){var n,t,e=this,o=e.f;o===e.RESOLVED?(n=e.p,e.l.clear(),t=e.d):o===e.REJECTED&&(n=e.l,e.p.clear(),t=e.h),n.each(function(n){s(function(){n(o,t)})})},_:function(e,o,i){var r=this;s(function(){if(q(o)){var n;try{n=o(i)}catch(t){return v.r(t),void r.i(t)}u(r,n)}else e===r.RESOLVED?r.u(i):e===r.REJECTED&&r.i(i)})},then:function(e,o){var n=this,i=new v;return n.p.enqueue(function(n,t){i._(n,e,t)}),n.l.enqueue(function(n,t){i._(n,o,t)}),n.f===n.RESOLVED?n.m():n.f===n.REJECTED&&n.m(),i}},v.all=function(a){return new v(function(o,i){var r=a.length,u=0,c=!1,s=[];function e(n,t,e){c||(null!==n&&(c=!0,i(n)),s[e]=t,(u+=1)===r&&(c=!0,o(s)))}for(var n=0;n<r;n+=1)!function(t){var n=a[t];n instanceof v||(n=new v(n)),n.then(function(n){e(null,n,t)},function(n){e(n||!0)})}(n)})},v.race=function(s){return new v(function(e,o){var n,i=s.length,r=!1,u=0;function t(n,t){r||(null==n?(r=!0,e(t)):i<=(u+=1)&&(r=!0,o(n)))}for(var c=0;c<i;c+=1)n=void 0,(n=s[c])instanceof v||(n=new v(n)),n.then(function(n){t(null,n)},function(n){t(n||!0)})})},v.step=function(e){var o=e.length,i=new v,r=function(t,n){if(o<=t)return i.u(n);new v(e[t]).then(function(n){r(t+1,n)},function(n){i.i(n)})};return new v(e[0]).then(function(n){r(1,n)},function(n){i.i(n)}),i},v.prototype.v=function(n,t){return this.then(n,t)},v),q,s,u,w;function t(){this.c=this.s=null}function v(n){var e=this;if(e.f=e.PENDING,e.p=new t,e.l=new t,q(n))try{n(function(n){e.u(n)},function(n){e.i(n)})}catch(o){v.r(o)}}_Promise.debug();var ajax={w:function(){return window.XMLHttpRequest&&window.JSON},g:function(n,t,e,o,i){var r=window.JSON.stringify(t);if(t&&"object"==typeof t){var u=[];for(var c in t)u.push(encodeURIComponent(c)+"="+encodeURIComponent(t[c]));r=u.join("&")}var s=new window.XMLHttpRequest;s.open("POST",n,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.setRequestHeader("Accept","application/json"),s.timeout=i,s.onload=function(){e(window.JSON.parse(s.responseText))},s.ontimeout=function(){o({error:"timeout"})},s.onreadystatechange=function(){4===s.readyState&&(200===s.status?e(window.JSON.parse(s.responseText)):o({error:"status: "+s.status}))},s.send(r)}},TIMEOUT=3e4,TIMEOUT_ERROR="网络不给力",loadJS=function(i,r){return new _Promise(function(n,t){var e=document.getElementsByTagName("head")[0],o=document.createElement("script");o.onload=o.onreadystatechange=function(){o.readyState&&"loaded"!==o.readyState&&"complete"!==o.readyState?t(TIMEOUT_ERROR):n(o)},o.onerror=function(){t(TIMEOUT_ERROR),o.parentNode.removeChild(o)},o.src=i,e.appendChild(o),setTimeout(function(){t(TIMEOUT_ERROR),o.parentNode.removeChild(o)},r||TIMEOUT)})},normalizeDomain=function(n){return n.replace(/^https?:\/\/|\/$/g,"")},normalizePath=function(n){return 0!==(n=n.replace(/\/+/g,"/")).indexOf("/")&&(n="/"+n),n},normalizeQuery=function(n){if(!n)return"";var t="?";for(var e in n)if(n.hasOwnProperty(e)){var o=n[e];t=t+encodeURIComponent(e)+"="+encodeURIComponent(o)+"&"}return"?"===t&&(t=""),t.replace(/&$/,"")},makeURL=function(n,t,e,o){if(!0===o)return e;n=n||location.protocol+"//",t=normalizeDomain(t);var i=normalizePath(e);return t&&(i=n+t+i),i},jsonp=function(r){var n=makeURL(r.protocol,r.domain,r.path,r.fullurl),u=r.query;return ajax.w()&&!r.get?new _Promise(function(t,e){ajax.g(n,u,function(n){t(n)},function(n){e(n)},r.timeout||TIMEOUT)}):new _Promise(function(e,t){var o=r.cb||"geetest_"+uid();r.cb?o=r.cb:u.callback=o;var i=n+normalizeQuery(u);window[o]=function(n){r&&r.recordurl&&((n=n||{}).url=i),e(n),window[o]=undefined;try{delete window[o]}catch(t){}},loadJS(i,r.timeout||TIMEOUT).v(function(){},function(n){t(n)})})},YDRZ=function(win,doc){var chrsz=8;function hex_md5(n){return binl2hex(core_md5(str2binl(n),n.length*chrsz))}function core_md5(n,t){n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;for(var e=1732584193,o=-271733879,i=-1732584194,r=271733878,u=0;u<n.length;u+=16){var c=e,s=o,a=i,f=r;e=md5_ff(e,o,i,r,n[u+0],7,-680876936),r=md5_ff(r,e,o,i,n[u+1],12,-389564586),i=md5_ff(i,r,e,o,n[u+2],17,606105819),o=md5_ff(o,i,r,e,n[u+3],22,-1044525330),e=md5_ff(e,o,i,r,n[u+4],7,-176418897),r=md5_ff(r,e,o,i,n[u+5],12,1200080426),i=md5_ff(i,r,e,o,n[u+6],17,-1473231341),o=md5_ff(o,i,r,e,n[u+7],22,-45705983),e=md5_ff(e,o,i,r,n[u+8],7,1770035416),r=md5_ff(r,e,o,i,n[u+9],12,-1958414417),i=md5_ff(i,r,e,o,n[u+10],17,-42063),o=md5_ff(o,i,r,e,n[u+11],22,-1990404162),e=md5_ff(e,o,i,r,n[u+12],7,1804603682),r=md5_ff(r,e,o,i,n[u+13],12,-40341101),i=md5_ff(i,r,e,o,n[u+14],17,-1502002290),e=md5_gg(e,o=md5_ff(o,i,r,e,n[u+15],22,1236535329),i,r,n[u+1],5,-165796510),r=md5_gg(r,e,o,i,n[u+6],9,-1069501632),i=md5_gg(i,r,e,o,n[u+11],14,643717713),o=md5_gg(o,i,r,e,n[u+0],20,-373897302),e=md5_gg(e,o,i,r,n[u+5],5,-701558691),r=md5_gg(r,e,o,i,n[u+10],9,38016083),i=md5_gg(i,r,e,o,n[u+15],14,-660478335),o=md5_gg(o,i,r,e,n[u+4],20,-405537848),e=md5_gg(e,o,i,r,n[u+9],5,568446438),r=md5_gg(r,e,o,i,n[u+14],9,-1019803690),i=md5_gg(i,r,e,o,n[u+3],14,-187363961),o=md5_gg(o,i,r,e,n[u+8],20,1163531501),e=md5_gg(e,o,i,r,n[u+13],5,-1444681467),r=md5_gg(r,e,o,i,n[u+2],9,-51403784),i=md5_gg(i,r,e,o,n[u+7],14,1735328473),e=md5_hh(e,o=md5_gg(o,i,r,e,n[u+12],20,-1926607734),i,r,n[u+5],4,-378558),r=md5_hh(r,e,o,i,n[u+8],11,-2022574463),i=md5_hh(i,r,e,o,n[u+11],16,1839030562),o=md5_hh(o,i,r,e,n[u+14],23,-35309556),e=md5_hh(e,o,i,r,n[u+1],4,-1530992060),r=md5_hh(r,e,o,i,n[u+4],11,1272893353),i=md5_hh(i,r,e,o,n[u+7],16,-155497632),o=md5_hh(o,i,r,e,n[u+10],23,-1094730640),e=md5_hh(e,o,i,r,n[u+13],4,681279174),r=md5_hh(r,e,o,i,n[u+0],11,-358537222),i=md5_hh(i,r,e,o,n[u+3],16,-722521979),o=md5_hh(o,i,r,e,n[u+6],23,76029189),e=md5_hh(e,o,i,r,n[u+9],4,-640364487),r=md5_hh(r,e,o,i,n[u+12],11,-421815835),i=md5_hh(i,r,e,o,n[u+15],16,530742520),e=md5_ii(e,o=md5_hh(o,i,r,e,n[u+2],23,-995338651),i,r,n[u+0],6,-198630844),r=md5_ii(r,e,o,i,n[u+7],10,1126891415),i=md5_ii(i,r,e,o,n[u+14],15,-1416354905),o=md5_ii(o,i,r,e,n[u+5],21,-57434055),e=md5_ii(e,o,i,r,n[u+12],6,1700485571),r=md5_ii(r,e,o,i,n[u+3],10,-1894986606),i=md5_ii(i,r,e,o,n[u+10],15,-1051523),o=md5_ii(o,i,r,e,n[u+1],21,-2054922799),e=md5_ii(e,o,i,r,n[u+8],6,1873313359),r=md5_ii(r,e,o,i,n[u+15],10,-30611744),i=md5_ii(i,r,e,o,n[u+6],15,-1560198380),o=md5_ii(o,i,r,e,n[u+13],21,1309151649),e=md5_ii(e,o,i,r,n[u+4],6,-145523070),r=md5_ii(r,e,o,i,n[u+11],10,-1120210379),i=md5_ii(i,r,e,o,n[u+2],15,718787259),o=md5_ii(o,i,r,e,n[u+9],21,-343485551),e=safe_add(e,c),o=safe_add(o,s),i=safe_add(i,a),r=safe_add(r,f)}return Array(e,o,i,r)}function md5_cmn(n,t,e,o,i,r){return safe_add(bit_rol(safe_add(safe_add(t,n),safe_add(o,r)),i),e)}function md5_ff(n,t,e,o,i,r,u){return md5_cmn(t&e|~t&o,n,t,i,r,u)}function md5_gg(n,t,e,o,i,r,u){return md5_cmn(t&o|e&~o,n,t,i,r,u)}function md5_hh(n,t,e,o,i,r,u){return md5_cmn(t^e^o,n,t,i,r,u)}function md5_ii(n,t,e,o,i,r,u){return md5_cmn(e^(t|~o),n,t,i,r,u)}function safe_add(n,t){var e=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(e>>16)<<16|65535&e}function bit_rol(n,t){return n<<t|n>>>32-t}function str2binl(n){for(var t=Array(),e=(1<<chrsz)-1,o=0;o<n.length*chrsz;o+=chrsz)t[o>>5]|=(n.charCodeAt(o/chrsz)&e)<<o%32;return t}function binl2hex(n){for(var t="0123456789abcdef",e="",o=0;o<4*n.length;o++)e+=t.charAt(n[o>>2]>>o%4*8+4&15)+t.charAt(n[o>>2]>>o%4*8&15);return e}var opts={getMobileUrl:{test01:"http://120.197.235.102/NumberAbility/h5/getMobile.htm?",pro:"http://www.cmpassport.com/NumberAbility/h5/getMobile.htm?"},getToken:{test01:"http://120.197.235.102/NumberAbility/h5/getToken.htm",pro:"https://www.cmpassport.com/NumberAbility/h5/getToken.htm"},optparams:{uuid:"",msgId:"",timestamp:dateFormat(new Date,"yyyyMMddhhmmssSSS"),userInformation:getFingerPrint(),isimge:!1}};function uuid(n,t){var e,o,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(t=t||i.length,n)for(e=0;e<n;e++)r[e]=i[0|Math.random()*t];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",e=0;e<36;e++)r[e]||(o=0|16*Math.random(),r[e]=i[19==e?3&o|8:o]);return r.join("")}function getFingerPrint(){return encodeURIComponent(base64encode(getBrowserInfo()))}function dateFormat(n,t){var e={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),"S+":n.getMilliseconds()};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[o]:((3==RegExp.$1.length&&"S+"==o?"000":"00")+e[o]).substr((""+e[o]).length)));return t}var YDRZ={getSign:function(n,t){return opts.optparams.uuid=uuid(32,32),opts.optparams.msgId=uuid(32,32),n+opts.optparams.msgId+opts.optparams.timestamp+opts.optparams.uuid+t},getTokenInfo:function(o){var n=""===o.data.expandParams?"callType=6005":"callType=6005|"+o.data.expandParams,i=""===o.data.expandParams?"callType=6006":"callType=6006|"+o.data.expandParams,r={version:o.data.version,appId:o.data.appId,openType:o.data.openType,expandParams:o.data.expandParams,isTest:o.data.isTest,sign:o.data.sign,uuid:opts.optparams.uuid,msgId:opts.optparams.msgId,timestamp:opts.optparams.timestamp,userInformation:opts.optparams.userInformation},t=("0"===r.isTest?opts.getMobileUrl.test01:opts.getMobileUrl.pro)+"version="+r.version+"&appId="+r.appId+"&openType="+r.openType+"&expandParams="+encodeURIComponent(n)+"&msgId="+r.msgId+"&timestamp="+r.timestamp+"&uuid="+r.uuid+"&userInformation="+r.userInformation,u=this;this.isLoaded=!1,this.isTimeout=!1;var c=doc.createElement("img");c.style.display="none",c.src=t,doc.body.appendChild(c);var s=null;0<o.data.timeout&&(s=setTimeout(function(){u.isTimeout=!0,o.error({code:"500",message:"超时",msgId:r.msgId})},o.data.timeout)),c.onload=function(){if(clearTimeout(s),!u.isTimeout){u.isLoaded=!0,doc.body.removeChild(c);var n={header:{version:r.version,msgId:r.msgId,timestamp:r.timestamp,appId:r.appId},body:{expandParams:i,sign:r.sign,uuid:r.uuid}},t="0"===r.isTest?opts.getToken.test01:opts.getToken.pro;try{request.ajax({request:{url:t,method:"post",data:JSON.stringify(n),timeout:o.data.timeout},success:function(n){if(""==n.result.body.token){t={code:n.result.header.resultCode,message:n.result.body.resultDesc};return o.error({code:t.code,message:t.message,msgId:r.msgId}),t}var t={code:n.result.header.resultCode,token:n.result.body.token,userInformation:r.userInformation,message:"获取token成功"};o.success({code:t.code,message:t.message,token:t.token,userInformation:t.userInformation})},error:function(n){var t={code:"500",message:"接口异常，获取token失败"};return o.error({code:t.code,message:t.message,msgId:r.msgId}),t}})}catch(e){throw new Error(e)}}},c.onerror=function(){u.isTimeout||(clearTimeout(s),o.error({code:"500",message:"取号失败",msgId:r.msgId}),u.isLoaded=!0,doc.body.removeChild(c))}}};function getBrowserInfo(){var n=navigator.userAgent,t=(-1<n.indexOf("Android")||n.indexOf("Linux"),window.navigator.platform+"@@"+window.navigator.userAgent+"@@"+window.navigator.appVersion+"@@"+window.navigator.cookieEnabled+"@@"+window.navigator.cpuClass+"@@"+window.navigator.hardwareConcurrency+"@@"+window.navigator.language+"@@"+window.navigator.plugins+"@@"+window.screen.availWidth+"@@"+window.navigator.availHeight+"@@"+window.screen.colorDepth+"@@"+window.Date.getTimezoneOffset);return window.navigator.platform+"@@"+window.navigator.userAgent+"@@"+hex_md5(t)}function base64encode(n){var t,e,o,i,r,u,c,s="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0;for(n=_utf8_encode(n);f<n.length;)i=(t=n.charCodeAt(f++))>>2,r=(3&t)<<4|(e=n.charCodeAt(f++))>>4,u=(15&e)<<2|(o=n.charCodeAt(f++))>>6,c=63&o,isNaN(e)?u=c=64:isNaN(o)&&(c=64),s=s+a.charAt(i)+a.charAt(r)+a.charAt(u)+a.charAt(c);return s}function _utf8_encode(n){n=n.replace(/\r\n/g,"\n");for(var t="",e=0;e<n.length;e++){var o=n.charCodeAt(e);o<128?t+=String.fromCharCode(o):(127<o&&o<2048?t+=String.fromCharCode(o>>6|192):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128)),t+=String.fromCharCode(63&o|128))}return t}var request={utilCreateXHR:function(n){var t=n&&n.window||window;if(t.XMLHttpRequest)return new t.XMLHttpRequest;for(var e=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","Microsoft.XMLHTTP"],o=0;o<e.length;o++)try{return new t.ActiveXObject(e[o])}catch(i){}},parseJson:function(text){var obj=!1;if(text||(obj={code:"ER_NOBODY",summary:"responseText is empty"}),win.JSON&&JSON.parse)try{obj=JSON.parse(text)}catch(ex){}if(!obj)try{obj=eval("("+text+")")}catch(ex){obj={code:"ER_INVALIDJSON",summary:"responseText is invalid json"}}return obj},ajax:function(n){var t=this,e=(n=n||{}).request||{},o=this.utilCreateXHR(n),i=n.success||new Function,r=n.error||new Function,u=e.timeout,c=null;0<u&&(c=setTimeout(function(){3==o.readyState&&200==o.status||(o.abort(),r({result:{code:"ER_TIMEOUT",summary:"timeout"}}))},u)),o.onreadystatechange=function(n){4==o.readyState&&(clearTimeout(c),0!=o.status?304==o.status||200<=o.status&&o.status<300?i({result:t.parseJson(o.responseText),text:o.responseText,status:o.status}):r({result:{code:"ER_NETWORK",summary:"network has error"},text:o.responseText,status:o.status}):r({result:{code:"ER_STATUS",summary:"status is 0"}}))};var s=e.method&&e.method.toLowerCase();o.open(s||"get",e.url,!0);var a=e.data;if(!e.isFormData&&"object"==typeof a){for(var f in a=[],e.data)a.push(f+"="+encodeURIComponent(e.data[f]));a=a.join("&")}if(e.headers)for(var f in e.headers)o.setRequestHeader(f,e.headers[f]);"post"==s&&a||(a=null),o.send(a)}};return YDRZ}(window,document),CUAU=(ue={precheckUrl:{test:"https://opencloud.wostore.cn/openapi-test/netauth/precheck/u3",pro:"https://opencloud.wostore.cn/openapi/netauth/precheck/u3"},optparams:{uuid:"",timestamp:Date.now(),version:"v4.0",clientType:"2",format:"jsonp",clientId:"",timeout:5e3,result:""}},{getSign:function(n){return"cuCallback"+n+ue.optparams.clientType+ue.optparams.format+ue.optparams.timestamp+ue.optparams.version},getAuthCode:function(n){if("[object Function]"!==Object.prototype.toString.call(n.result))throw{error:"arguments invalid"};ue.optparams.clientId=n.clientId,ue.optparams.timeout=n.timeout,ue.optparams.result=n.result,ue.optparams.uuid=function u(n,t){var e,o,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(t=t||i.length,n)for(e=0;e<n;e++)r[e]=i[0|Math.random()*t];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",e=0;e<36;e++)r[e]||(o=0|16*Math.random(),r[e]=i[19==e?3&o|8:o]);return r.join("")}(32,32),function r(n){var t=ue.optparams.timeout,e="cuCallback",o={callback:e,timestamp:ue.optparams.timestamp,client_id:ue.optparams.clientId,client_type:ue.optparams.clientType,version:ue.optparams.version,format:ue.optparams.format,sign:n},i={code:"408",msg:"请求超时"};jsonp({get:!0,path:ue.precheckUrl.pro,query:o,fullurl:!0,cb:e,timeout:t}).v(function(n){var t={code:n.code,msg:n.msg};0==n.code?(t.accesscode=n.data.accessCode,t.operatorType=n.data.operatorType):t.msgId=n.data,ue.optparams.result(t)},function(n){("网络不给力"==n||n.status&&"timeout"==n.status)&&!function t(n){ue.optparams.result({code:n.code,msg:n.msg})}(i)})}(n.sign)}}),ue;function Error$1(){}Error$1.pre_gateway_net=function(){return{code:100}},Error$1.pre_gateway_result=function(){return{code:101}},Error$1.pre_getmobile_net=function(){return{code:102}},Error$1.pre_getmobile_result=function(){return{code:103}},Error$1.cm_token_error=function(){return{code:104}},Error$1.record_token_net=function(){return{code:105}},Error$1.record_token_result=function(){return{code:106}},Error$1.cu_token_error=function(){return{code:107}},Error$1.change_gateway=function(n){return{code:n&&n.code||108}};var user_agent=navigator.userAgent.toLowerCase(),connection=navigator.connection||navigator.mozConnection||navigator.webkitConnection||{type:"unknown"},common_cell=["cellular","2g","3g","4g"],checkNetInfo=function(){if(-1!==user_agent.indexOf("nettype/wifi"))return"wifi";var n=connection&&connection.type;return n&&-1!==common_cell.indexOf(n)?"cellular":"wifi"===n?"wifi":"unknown"},Ve,We;Ve="undefined"!=typeof window?window:undefined,We=function(r,n){function u(n){this.y=n}function t(n){var e=this;new u(n).T(function(n,t){e[n]=t})}function e(){this.n={}}if(void 0===r)throw new Error("Geetest requires browser environment");var c=r.document,s=r.Math,a=c&&c.getElementsByTagName("head")[0];u.prototype={T:function(n){var t=this.y;for(var e in t)t.hasOwnProperty(e)&&n(e,t[e]);return this}},t.prototype={api_server:"dkapi.geetest.com",type_path:"/deepknow/v2/gettype",protocol:"https://",https:!0,static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"sense_v2",I:function(n){var e=this;new u(n).T(function(n,t){e[n]=t})}};var o=function(n){return"function"==typeof n},f=function(n,t,e,o){t=t.replace(/^https?:\/\/|\/$/g,"");var i,r=(0!==(i=(i=e).replace(/\/+/g,"/")).indexOf("/")&&(i="/"+i),i+function(n){if(!n)return"";var e="?";return new u(n).T(function(n,t){"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(e=e+encodeURIComponent(n)+"="+encodeURIComponent(t)+"&")}),"?"===e&&(e=""),e.replace(/&$/,"")}(o));return t&&(r=n+t+r),r},d=function(n,e,o,i,r){var u=function(t){!function(n,t){var e=c.createElement("script");e.charset="UTF-8",e.async=!0;var o=!(e.onerror=function(){t(!0)});e.onload=e.onreadystatechange=function(){o||e.readyState&&"loaded"!==e.readyState&&"complete"!==e.readyState||(o=!0,setTimeout(function(){t(!1)},0))},e.src=n,a&&a.appendChild(e)}(f(n,e[t],o,i),function(n){n?t>=e.length-1?r(!0):u(t+1):r(!1)})};u(0)},i=function(n,t,e,o){var i="geetest_"+(parseInt(1e4*s.random())+(new Date).valueOf());r[i]=function(n){o("success"===n.status?n.data:n),r[i]=undefined;try{delete r[i]}catch(t){}},d(e.protocol,n,t,{callback:i},function(n){n&&m("networkError",e)})},m=function(n,t){var e={noAppId:"缺少app_id",networkError:"网络错误",idNotExist:"参数id必填",cbIlegal:"callback必须是function",geetestNotExist:"Geetest不存在"};if("function"!=typeof t.onError)throw new Error(e[n]);t.onError(e[n])},h=null;e.prototype={t:function(n,t){return this.n[n]?this.n[n].push(t):this.n[n]=[t],this},e:function(n,t){var e=this.n[n];if(e){for(var o=0,i=e.length;o<i;o+=1)e[o](t);return this}},o:function(){this.n={}}};var p,l=new e,_=(p=function(){for(var n={},t=c.getElementsByTagName("script"),e=t.length-1;-1<e;e--){var o=t[e];if(o&&o.getAttribute("src")&&(-1<o.getAttribute("src").indexOf("sense_id")||-1<o.getAttribute("src").indexOf("v2.sense.js"))){for(var i,r=o.src,u=/(?:\?|&)(.*?)=(.*?)(?=&|$)/g;null!==(i=u.exec(r));)n[i[1]]=decodeURIComponent(i[2]);break}}return n.sense_id="31a48581039c5b99e87699ed9271b0a2",n.sense_id&&(n.id=n.sense_id,delete n.sense_id),n}(),function(){var n,e=new t;e.debugConfig&&e.I(e.debugConfig),"http:"!==r.location.protocol&&"https:"!==r.location.protocol?e.protocol="https://":e.protocol=r.location.protocol+"//",p?e.I(p):m("noAppId",e),n=n||"sense_v2",(r.Geetest?r.Geetest[n]:r.Geetest&&r.Geetest[n])?h=new r.Geetest(e):i([e.api_server],e.type_path,e,function(t){d(e.protocol,t.static_servers,t.path,null,function(n){if(n)m("networkError",e);else{if("undefined"==typeof r.Geetest)return m("geetestNotExist",e),0;e.I(t),h=new r.Geetest(e),r.Geetest.sense||(r.Geetest=null),l.e("ready")}})})});return r.SensePro={load:_,destroy:function(){h&&h.destroy()},getSid:function(n,t){if(h)return h.getSid(n,t);o(t)&&t({code:"2001",msg:"sense对象未加载成功"})},onReady:function(n){l.o(),l.t("ready",function(){n()},!1)}},SensePro},"object"==typeof module&&"object"==typeof module.exports?module.exports=Ve.document?We(Ve,!0):function(n){if(!n.document)throw new Error("Geetest requires a window with a document");return We(n)}:We(Ve);var canClick=!0;function Onepass(n){if(this.gtapi_domain="onepass.geetest.com",this.protocol=n.protocol?n.protocol+"//":location.protocol+"//",extend(this,n),this.phone=0,this.process_id="",this.b=new PureEvent,this.presign=YDRZ.getSign("","1.2"),this.presign_cu=CUAU.getSign("{client_id}"),this.OnepassConfig={haspreASK:!1,presign:this.presign,presign_cu:this.presign_cu,data:{},cb:"geetest_"+uid(),ip:!1},this.pre_init=n.pre_init===undefined||n.pre_init,this.pre_init&&this.A(),this.pre_sense=n.sense===undefined||n.sense,this.pre_sense)try{window.SensePro&&window.SensePro.load()}catch(t){console.log(t)}}Onepass.prototype={constructor:Onepass,k:function(n){var e=this;if(e.phone=n&&n.phone||"",canClick){canClick=!1;var t=e.OnepassConfig.haspreASK&&e.OnepassConfig.data.data&&!e.OnepassConfig.ip&&!e.phone;if(e.OnepassConfig.haspreASK&&e.OnepassConfig.data.data&&e.OnepassConfig.ip||t)e.S(e.OnepassConfig.data,e.OnepassConfig.cb);else{var o=e.b,i="geetest_"+uid(),r=YDRZ.getSign("","1.2"),u=CUAU.getSign("{client_id}");jsonp({protocol:this.protocol,domain:this.gtapi_domain,path:"/web/pre_gateway",query:{app_id:e.app_id,sdk:"2.2.1",phone:e.phone,presign:r,presign_cu:u,clienttype:1,callback:i},timeout:this.timeout}).v(function(t){if(t&&200===t.status)window.SensePro&&window.SensePro.getSid(function(n){n&&e.R(t.process_id,n)}),e.S(t,i);else{canClick=!0;var n=guid();o.e(GATEWAY_FAIL,Error$1.pre_gateway_result()),e.C({process_id:n,msg:"请求pregateway出错",phone:e.phone},"101")}},function(){canClick=!0,o.e(GATEWAY_FAIL,Error$1.pre_gateway_net());var n=guid();e.C({process_id:n,msg:"请求pregateway失败",phone:e.phone},"100")})}}},U:function(n,t,e){var o=this,i=o.b;jsonp({get:!0,path:n.url,query:n.option[t],fullurl:!0,cb:e,timeout:o.timeout}).v(function(n){canClick=!0,!n||1e4!==n.result&&0!==n.result?(i.e(GATEWAY_FAIL,Error$1.pre_getmobile_result()),o.C(n,"103")):(i.e(GATEWAY_SUCCESS,{process_id:o.process_id,phone:o.phone,accesscode:n.data}),o.C(n,"0"))},function(){canClick=!0,i.e(GATEWAY_FAIL,Error$1.pre_getmobile_net()),o.C({code:400,msg:"接口请求失败 ||超时"},"400")})},x:function(n,t){var e=this,o=e.b,i=n.option[t].appid,r=n.option[t].sign;YDRZ.getTokenInfo({data:{version:"1.2",appId:i,sign:r,openType:"1",timeout:e.timeout||3e3},success:function(n){canClick=!0,o.e(GATEWAY_SUCCESS,{process_id:e.process_id,phone:e.phone,accesscode:n.token+"||"+n.userInformation}),e.C(n,"0")},error:function(n){canClick=!0,o.e(GATEWAY_FAIL,Error$1.cm_token_error()),e.C(n,"104")}})},M:function(n,t){var e=this,o=e.b;CUAU.getAuthCode({clientId:n.option[t].client_id,sign:n.option[t].sign,timeout:e.timeout||3e3,result:function(n){"0"==n.code?n.operatorType&&"CU"===n.operatorType&&(canClick=!0,o.e(GATEWAY_SUCCESS,{process_id:e.process_id,phone:e.phone,accesscode:n.accesscode}),e.C(n,"0")):(canClick=!0,o.e(GATEWAY_FAIL,Error$1.cu_token_error()),e.C(n,"107"))}})},j:function(){this.process_id=""},t:function(n,t){return this.b.t(n,t),this},C:function(n,t){var e=t||"undefined";n&&"object"==typeof n&&(n=JSON.stringify(n));var o=this.process_id||n&&n.process_id,i=checkNetInfo();jsonp({protocol:this.protocol,domain:this.gtapi_domain,query:{process_id:o,code:e,metadata:n,cell:i},path:"/web/client_report",timeout:this.timeout})},A:function(){var o=this;jsonp({protocol:this.protocol,domain:this.gtapi_domain,path:"/web/pre_gateway",query:{app_id:o.app_id,sdk:"2.2.1",presign:o.OnepassConfig.presign,presign_cu:o.OnepassConfig.presign_cu,clienttype:1,callback:o.OnepassConfig.cb,type:"pre"},timeout:this.timeout}).v(function(n){o.OnepassConfig.haspreASK=!0;var t="";if(n&&200===n.status)o.OnepassConfig.data=n,o.OnepassConfig.ip=n.data&&1===n.data.operator_rule||!1,t=n.process_id||"",window.SensePro&&window.SensePro.onReady(function(){window.SensePro.getSid(function(n){n&&o.R(t,n)})});else{var e=guid();o.OnepassConfig.haspreASK=!0,o.OnepassConfig.ip=!1,o.C({process_id:e,msg:"请求pregateway出错"},"101")}},function(){var n=guid();o.OnepassConfig.haspreASK=!1,o.OnepassConfig.ip=!1,o.C({process_id:n,msg:"请求pregateway失败"},"100")})},S:function(n,t){var e=this;e.process_id=n.process_id,e.OnepassConfig.haspreASK=!1,n.data&&1===n.data.operator?e.x(n.data,n.data.operator):n.data&&3===n.data.operator?e.M(n.data,n.data.operator):e.U(n.data,n.data.operator,t)},R:function(n,t){jsonp({protocol:this.protocol,domain:this.gtapi_domain,query:{process_id:n,deepknow_session_id:t},path:"/web/deep_know",timeout:this.timeout})}};var data=(Vh=[],{O:function(n,t){Vh[n]=t},P:function(n){return Vh[n]}}),Vh;function GOP(n){this.G=uid(),this.N=!0,data.O(this.G,new Onepass(n))}return GOP.version="2.2.1",GOP.prototype={gateway:function(n){return this.N&&data.P(this.G).k(n),this},onGatewaySuccess:function(n){return this.N&&data.P(this.G).t(GATEWAY_SUCCESS,n),this},onGatewayFail:function(n){return this.N&&data.P(this.G).t(GATEWAY_FAIL,n),this},checkNetInfo:function(){return checkNetInfo()}},GOP});
